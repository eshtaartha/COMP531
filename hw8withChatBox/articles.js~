const express = require('express')
const bodyParser = require('body-parser')

const addArticle = (req, res) => {
     console.log('Payload received', req.body)
     
     req2 = req.body;
     
     articles.push(
     {
     id:4,
     author:"Piccolo",
     text:
     }) // add id and other parameters to article body and append it to array
     
     res.send(articles[3]) //return article with id and author
     
}

const hello = (req, res) => res.send({ hello: 'world2' })

articles=[ //create 3 articles
{
id:1,
author:"Goku",
text:"This is my first article"
},
{
id:2,
author:"Vageta",
text:"This is my second article"
},
{
id:3,
author:"MajinBuu",
text:"This is my third article"
}];

const sendBackArticles = (req, res) => 
{
res.send({articles}); //respond with 3 articles
}

const app = express()
app.use(bodyParser.json())
app.post('/article', addArticle)
app.get('/', hello)
app.get('/articles',sendBackArticles) 

// Get the port from the environment, i.e., Heroku sets it
const port = process.env.PORT || 3000
const server = app.listen(port, () => {
     const addr = server.address()
     console.log(`Server listening at http://${addr.address}:${addr.port}`)
})
